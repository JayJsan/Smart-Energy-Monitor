Version 4
SHEET 1 2040 1260
WIRE 64 96 32 96
WIRE 160 96 144 96
WIRE -560 112 -720 112
WIRE -400 112 -560 112
WIRE -560 144 -560 112
WIRE -400 144 -400 112
WIRE -80 224 -112 224
WIRE 32 224 32 96
WIRE 32 224 0 224
WIRE 1040 224 928 224
WIRE 32 240 32 224
WIRE 64 240 32 240
WIRE 1168 240 1104 240
WIRE 1264 240 1168 240
WIRE -720 256 -720 112
WIRE -560 256 -560 224
WIRE 160 256 160 96
WIRE 160 256 128 256
WIRE 192 256 160 256
WIRE 368 256 320 256
WIRE 528 256 448 256
WIRE 560 256 528 256
WIRE 960 256 832 256
WIRE 1040 256 960 256
WIRE 64 272 32 272
WIRE -400 288 -400 224
WIRE -304 288 -400 288
WIRE -80 288 -112 288
WIRE 32 288 32 272
WIRE 32 288 0 288
WIRE 32 304 32 288
WIRE 528 304 528 256
WIRE -560 352 -560 336
WIRE -480 352 -560 352
WIRE -560 368 -560 352
WIRE -400 368 -400 288
WIRE 32 400 32 384
WIRE 960 400 960 256
WIRE 1024 400 960 400
WIRE 1168 400 1168 240
WIRE 1168 400 1104 400
WIRE 528 416 528 368
WIRE -720 464 -720 336
WIRE -560 464 -560 448
WIRE -560 464 -720 464
WIRE -400 464 -400 448
WIRE -400 464 -560 464
WIRE -560 512 -560 464
FLAG -560 512 0
FLAG 528 416 0
FLAG -720 112 Vac
FLAG 1152 864 Vsupply
FLAG 96 288 0
FLAG 96 224 Vsupply
FLAG -112 288 Vsense
FLAG -112 224 0
FLAG 192 256 Vvo
FLAG 32 400 Voff
FLAG 320 256 Vvo
FLAG -304 288 Vsense
FLAG 1072 272 0
FLAG 1264 240 Vout
FLAG 928 224 Voff
FLAG 1072 208 Vsupply
FLAG 752 256 Vfilter
FLAG 560 256 Vfilter
FLAG -480 352 Isense
FLAG 1344 864 Voff
FLAG 1152 944 0
FLAG 1344 944 0
SYMBOL res -416 128 R0
SYMATTR InstName Ra
SYMATTR Value 20.78k
SYMBOL ind -576 128 R0
SYMATTR InstName L1
SYMATTR Value 4mH
SYMBOL res -576 240 R0
SYMATTR InstName R2
SYMATTR Value 25
SYMBOL res -576 352 R0
SYMATTR InstName Rsense
SYMATTR Value 0.5952
SYMBOL voltage -720 240 R0
WINDOW 3 -94 106 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value SINE(0 19.8 500)
SYMATTR InstName Vac
SYMBOL res -416 352 R0
SYMATTR InstName Rb
SYMATTR Value 1k
SYMBOL res 464 240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 1591.55
SYMBOL cap 512 304 R0
SYMATTR InstName C1
SYMATTR Value 10nF
SYMBOL Opamps/opamp2 96 192 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U2
SYMATTR Value LM324
SYMBOL res 16 272 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName R8
SYMATTR Value 4.6k
SYMBOL res 16 208 R90
WINDOW 0 -32 53 VBottom 2
WINDOW 3 -32 55 VTop 2
SYMATTR InstName R9
SYMATTR Value 5.6k
SYMBOL res 160 80 R90
WINDOW 0 -30 61 VBottom 2
WINDOW 3 -31 62 VTop 2
SYMATTR InstName R10
SYMATTR Value 5.6k
SYMBOL res 48 400 R180
WINDOW 0 -62 57 Left 2
WINDOW 3 -44 34 Left 2
SYMATTR InstName R11
SYMATTR Value 5.6k
SYMBOL Opamps/opamp2 1072 176 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName OPAMP1
SYMATTR Value LM324
SYMBOL res 848 240 R90
WINDOW 0 -30 61 VBottom 2
WINDOW 3 -2 61 VBottom 2
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL res 1120 384 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 250k
SYMBOL voltage 1152 848 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 5
SYMBOL voltage 1344 848 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 2.1
TEXT -736 64 Left 2 ;Voltage and Current Sense Circuit
TEXT -88 8 Left 2 ;Level Shift & Amplification
TEXT 416 168 Left 2 ;Voltage Filter
TEXT -744 1216 Left 2 !.tran 0 0.104 0.1 0.0001\n.lib LM324.lib
TEXT 872 64 Left 2 ;Voltage Zero Crossing Detector
TEXT 736 152 Left 2 ;2.1V Reference Voltage
TEXT -1160 136 Left 2 ;Vnoise simulates noise in the circuit
TEXT 968 456 Left 2 ;100k, 150k series
RECTANGLE Normal 880 1152 -944 592 2
RECTANGLE Normal -1184 560 -208 -16 2
RECTANGLE Normal 1360 560 -208 -16 2
RECTANGLE Normal 1360 -592 -208 -16 2
