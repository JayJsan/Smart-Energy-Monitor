% voltage = [484, 512, 398, 294, 242, 266, 353, 468, 565, 602, 562, 465, 351, 264, 243, 296, 401, 515, 589, 594, 528, 417, 308, 246, 257, 336, 451, 553, 601, 573, 484, 368, 274, 241, 283, 382, 497, 582, 598, 542, 435, 324, 252, 250, 320, 432, 539, 598, 583, 501, 387, 286, 242, 272, 364, 480, 572, 601, 555, 454, 340, 259, 246, 305, 413, 524, 593, 590, 517, 406, 299, 244, 262, 347, 462, 561, 602, 567, 472, 358, ]
% current = [432, 457, 342, 260, 245, 303, 410, 523, 593, 591, 520, 408, 301, 244, 261, 344, 460, 559, 601, 568, 475, 360, 269, 242, 290, 391, 506, 586, 596, 535, 426, 316, 249, 253, 328, 442, 546, 600, 579, 493, 378, 280, 241, 278, 373, 489, 577, 600, 548, 445, 332, 255, 248, 312, 422, 532, 596, 587, 509, 396, 293, 242, 267, 355, 471, 566, 601, 561, 463, 349, 263, 243, 298, 403, 516, 591, 593, 525, 415, 0, ]
% VoltageLA = [484, 498, 512, 455, 398, 346, 294, 268, 242, 254, 266, 309, 353, 410, 468, 516, 565, 583, 602, 582, 562, 513, 465, 408, 351, 307, 264, 253, 243, 269, 296, 348, 401, 458, 515, 552, 589, 591, 594, 561, 528, 472, 417, 362, 308, 277, 246, 251, 257, 296, 336, 393, 451, 502, 553, 577, 601, 587, 573, 528, 484, 426, 368, 321, 274, 257, 241, 262, 283, 332, 382, 439, 497, 539, 582, 590, 598, 570, 542, 488, 435, 379, 324, 288, 252, 251, 250, 285, 320, 376, 432, 485, 539, 568, 598, 590, 583, 542, 501, 444, 387, 336, 286, 264, 242, 257, 272, 318, 364, 422, 480, 526, 572, 586, 601, 578, 555, 504, 454, 397, 340, 299, 259, 252, 246, 275, 305, 359, 413, 468, 524, 558, 593, 591, 590, 553, 517, 461, 406, 352, 299, 271, 244, 253, 262, 304, 347, 404, 462, 511, 561, 581, 602, 584, 567, 519, 472, 415, 358, 179, ]
% CurrentLA = [444, 457, 399, 342, 301, 260, 252, 245, 274, 303, 356, 410, 466, 523, 558, 593, 592, 591, 555, 520, 464, 408, 354, 301, 272, 244, 252, 261, 302, 344, 402, 460, 509, 559, 580, 601, 584, 568, 521, 475, 417, 360, 314, 269, 255, 242, 266, 290, 340, 391, 448, 506, 546, 586, 591, 596, 565, 535, 480, 426, 371, 316, 282, 249, 251, 253, 290, 328, 385, 442, 494, 546, 573, 600, 589, 579, 536, 493, 435, 378, 329, 280, 260, 241, 259, 278, 325, 373, 431, 489, 533, 577, 588, 600, 574, 548, 496, 445, 388, 332, 293, 255, 251, 248, 280, 312, 367, 422, 477, 532, 564, 596, 591, 587, 548, 509, 452, 396, 344, 293, 267, 242, 254, 267, 311, 355, 413, 471, 518, 566, 583, 601, 581, 561, 512, 463, 406, 349, 306, 263, 253, 243, 270, 298, 350, 403, 459, 516, 553, 591, 592, 593, 559, 525, 470, 415, 207, 129, 51, 267, ]


% voltage = [1655, 2001, 2128, 2221, 2241, 2182, 2060, 1938, 1855, 1855, 1933, 2060, 2177, 2241, 2226, 2133, 2006, 1894, 1845, 1879, 1982, 2114, 2211, 2246, 2192, 2080, 1953, 1865, 1850, 1918, 2041, 2163, 2236, 2236, 2148, 2026, 1914, 1850, 1875, 1967, 2094, 2202, 2246, 2207, 2099, 1972, 1875, 1850, 1904, 2021, 2143, 2231, 2241, 2163, 2045, 1928, 1850, 1860, 1948, 2075, 2187, 2246, 2216, 2119, 1992, 1884, 1845, 1894, 1997, 2124, 2221, 2246, 2182, 2065, 1943, 1860, 1855, 1933, 2055, 2172, ];
% current = [1899, 2065, 2187, 2241, 2221, 2124, 1997, 1889, 1845, 1884, 1992, 2124, 2216, 2246, 2187, 2070, 1943, 1860, 1855, 1928, 2050, 2167, 2241, 2231, 2143, 2016, 1904, 1850, 1875, 1972, 2104, 2207, 2246, 2202, 2089, 1962, 1870, 1850, 1914, 2026, 2153, 2236, 2236, 2158, 2036, 1918, 1850, 1865, 1958, 2084, 2197, 2246, 2211, 2109, 1982, 1879, 1845, 1899, 2011, 2133, 2226, 2241, 2172, 2055, 1933, 1855, 1860, 1943, 2065, 2182, 2241, 2221, 2128, 2001, 1889, 1850, 1884, 1987, 2119, 0, ];
% RMSVoltage = [ 2047 ]
% RMSCurrent = [ 2036 ]
% VoltageLA = [1655, 1828, 2001, 2064, 2128, 2174, 2221, 2231, 2241, 2211, 2182, 2121, 2060, 1999, 1938, 1896, 1855, 1855, 1855, 1894, 1933, 1996, 2060, 2118, 2177, 2209, 2241, 2233, 2226, 2179, 2133, 2069, 2006, 1950, 1894, 1869, 1845, 1862, 1879, 1930, 1982, 2048, 2114, 2162, 2211, 2228, 2246, 2219, 2192, 2136, 2080, 2016, 1953, 1909, 1865, 1857, 1850, 1884, 1918, 1979, 2041, 2102, 2163, 2199, 2236, 2236, 2236, 2192, 2148, 2087, 2026, 1970, 1914, 1882, 1850, 1862, 1875, 1921, 1967, 2030, 2094, 2148, 2202, 2224, 2246, 2226, 2207, 2153, 2099, 2035, 1972, 1923, 1875, 1862, 1850, 1877, 1904, 1962, 2021, 2082, 2143, 2187, 2231, 2236, 2241, 2202, 2163, 2104, 2045, 1986, 1928, 1889, 1850, 1855, 1860, 1904, 1948, 2011, 2075, 2131, 2187, 2216, 2246, 2231, 2216, 2167, 2119, 2055, 1992, 1938, 1884, 1864, 1845, 1869, 1894, 1945, 1997, 2060, 2124, 2172, 2221, 2233, 2246, 2214, 2182, 2123, 2065, 2004, 1943, 1901, 1860, 1857, 1855, 1894, 1933, 1994, 2055, 2113, 2172, 1086, ];
% CurrentLA = [1982, 2065, 2126, 2187, 2214, 2241, 2231, 2221, 2172, 2124, 2060, 1997, 1943, 1889, 1867, 1845, 1864, 1884, 1938, 1992, 2058, 2124, 2170, 2216, 2231, 2246, 2216, 2187, 2128, 2070, 2006, 1943, 1901, 1860, 1857, 1855, 1891, 1928, 1989, 2050, 2108, 2167, 2204, 2241, 2236, 2231, 2187, 2143, 2079, 2016, 1960, 1904, 1877, 1850, 1862, 1875, 1923, 1972, 2038, 2104, 2155, 2207, 2226, 2246, 2224, 2202, 2145, 2089, 2025, 1962, 1916, 1870, 1860, 1850, 1882, 1914, 1970, 2026, 2089, 2153, 2194, 2236, 2236, 2236, 2197, 2158, 2097, 2036, 1977, 1918, 1884, 1850, 1857, 1865, 1911, 1958, 2021, 2084, 2140, 2197, 2221, 2246, 2228, 2211, 2160, 2109, 2045, 1982, 1930, 1879, 1862, 1845, 1872, 1899, 1955, 2011, 2072, 2133, 2179, 2226, 2233, 2241, 2206, 2172, 2113, 2055, 1994, 1933, 1894, 1855, 1857, 1860, 1901, 1943, 2004, 2065, 2123, 2182, 2211, 2241, 2231, 2221, 2174, 2128, 2064, 2001, 1945, 1889, 1869, 1850, 1867, 1884, 1935, 1987, 2053, 2119, 1059, 661, 264, 959, ];

voltage = [2065, 2456, 1708, 1093, 888, 1181, 1826, 2578, 3125, 3222, 2836, 2143, 1416, 947, 957, 1420, 2148, 2846, 3227, 3105, 2568, 1821, 1171, 888, 1103, 1713, 2460, 3061, 3242, 2919, 2260, 1518, 996, 922, 1323, 2026, 2749, 3198, 3159, 2675, 1943, 1259, 898, 1040, 1596, 2348, 2988, 3247, 3002, 2382, 1630, 1054, 898, 1235, 1904, 2646, 3159, 3203, 2773, 2065, 1352, 922, 986, 1489, 2226, 2905, 3242, 3071, 2495, 1748, 1123, 888, 1152, 1787, 2539, 3100, 3227, 2866, 2187, 1455, ]
current = [1816, 2084, 1367, 932, 981, 1469, 2207, 2895, 3237, 3076, 2514, 1762, 1132, 888, 1142, 1767, 2519, 3095, 3232, 2880, 2202, 1464, 971, 937, 1372, 2089, 2802, 3212, 3134, 2622, 1884, 1215, 893, 1069, 1655, 2407, 3027, 3247, 2963, 2319, 1577, 1020, 908, 1279, 1967, 2700, 3178, 3183, 2729, 2006, 1308, 913, 1010, 1542, 2290, 2949, 3247, 3037, 2436, 1684, 1083, 893, 1191, 1845, 2592, 3129, 3217, 2822, 2124, 1401, 942, 961, 1435, 2167, 2856, 3232, 3100, 2553, 1806, 0, ]
RMSVoltage = [ 2218 ]
RMSCurrent = [ 2203 ]
VoltageLA = [2065, 2260, 2456, 2082, 1708, 1400, 1093, 990, 888, 1034, 1181, 1503, 1826, 2202, 2578, 2851, 3125, 3173, 3222, 3029, 2836, 2489, 2143, 1779, 1416, 1181, 947, 952, 957, 1188, 1420, 1784, 2148, 2497, 2846, 3036, 3227, 3166, 3105, 2836, 2568, 2194, 1821, 1496, 1171, 1029, 888, 995, 1103, 1408, 1713, 2086, 2460, 2760, 3061, 3151, 3242, 3080, 2919, 2589, 2260, 1889, 1518, 1257, 996, 959, 922, 1122, 1323, 1674, 2026, 2387, 2749, 2973, 3198, 3178, 3159, 2917, 2675, 2309, 1943, 1601, 1259, 1078, 898, 969, 1040, 1318, 1596, 1972, 2348, 2668, 2988, 3117, 3247, 3124, 3002, 2692, 2382, 2006, 1630, 1342, 1054, 976, 898, 1066, 1235, 1569, 1904, 2275, 2646, 2902, 3159, 3181, 3203, 2988, 2773, 2419, 2065, 1708, 1352, 1137, 922, 954, 986, 1237, 1489, 1857, 2226, 2565, 2905, 3073, 3242, 3156, 3071, 2783, 2495, 2121, 1748, 1435, 1123, 1005, 888, 1020, 1152, 1469, 1787, 2163, 2539, 2819, 3100, 3163, 3227, 3046, 2866, 2526, 2187, 1821, 1455, 728, ]
CurrentLA = [1950, 2084, 1725, 1367, 1149, 932, 956, 981, 1225, 1469, 1838, 2207, 2551, 2895, 3066, 3237, 3156, 3076, 2795, 2514, 2138, 1762, 1447, 1132, 1010, 888, 1015, 1142, 1454, 1767, 2143, 2519, 2807, 3095, 3163, 3232, 3056, 2880, 2541, 2202, 1833, 1464, 1217, 971, 954, 937, 1154, 1372, 1730, 2089, 2445, 2802, 3007, 3212, 3173, 3134, 2878, 2622, 2253, 1884, 1549, 1215, 1054, 893, 981, 1069, 1362, 1655, 2031, 2407, 2717, 3027, 3137, 3247, 3105, 2963, 2641, 2319, 1948, 1577, 1298, 1020, 964, 908, 1093, 1279, 1623, 1967, 2333, 2700, 2939, 3178, 3180, 3183, 2956, 2729, 2367, 2006, 1657, 1308, 1110, 913, 961, 1010, 1276, 1542, 1916, 2290, 2619, 2949, 3098, 3247, 3142, 3037, 2736, 2436, 2060, 1684, 1383, 1083, 988, 893, 1042, 1191, 1518, 1845, 2218, 2592, 2860, 3129, 3173, 3217, 3019, 2822, 2473, 2124, 1762, 1401, 1171, 942, 951, 961, 1198, 1435, 1801, 2167, 2511, 2856, 3044, 3232, 3166, 3100, 2826, 2553, 2179, 1806, 903, 564, 225, 1145, ]



CalculatedRMSVoltage = RMSCalc(voltage)
CalculatedRMSCurrnet = RMSCalc(current)

CalculatedPower = (VoltageLA/1000) .* (CurrentLA/1000);
time = 1:length(voltage);
time2 = 1:length(VoltageLA);

tiledlayout(2,1)

nexttile
plot(time2, VoltageLA, time2, CurrentLA);
title("Voltage and current on same scale");
legend("Voltage", "Current");

nexttile
plot(time2,CalculatedPower, "bo");
title("power estimate");


